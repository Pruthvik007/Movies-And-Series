import{_ as G,e as Q,n as te,i as x,f as A,t as re,g as se,h as D,k,s as ne,l as ie,m as P,S as ae,o as L,p as ue,q as oe,R as S,v as ce,w as K,C as B,x as le,I as V,y as R,d as q}from"./index-vDcMo-XS.js";var Y=function(n){G(s,n);function s(i,t){var e;return e=n.call(this)||this,e.client=i,e.options=t,e.trackedProps=[],e.selectError=null,e.bindMethods(),e.setOptions(t),e}var r=s.prototype;return r.bindMethods=function(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)},r.onSubscribe=function(){this.listeners.length===1&&(this.currentQuery.addObserver(this),H(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())},r.onUnsubscribe=function(){this.listeners.length||this.destroy()},r.shouldFetchOnReconnect=function(){return C(this.currentQuery,this.options,this.options.refetchOnReconnect)},r.shouldFetchOnWindowFocus=function(){return C(this.currentQuery,this.options,this.options.refetchOnWindowFocus)},r.destroy=function(){this.listeners=[],this.clearTimers(),this.currentQuery.removeObserver(this)},r.setOptions=function(t,e){var u=this.options,a=this.currentQuery;if(this.options=this.client.defaultQueryObserverOptions(t),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=u.queryKey),this.updateQuery();var c=this.hasListeners();c&&W(this.currentQuery,a,this.options,u)&&this.executeFetch(),this.updateResult(e),c&&(this.currentQuery!==a||this.options.enabled!==u.enabled||this.options.staleTime!==u.staleTime)&&this.updateStaleTimeout();var o=this.computeRefetchInterval();c&&(this.currentQuery!==a||this.options.enabled!==u.enabled||o!==this.currentRefetchInterval)&&this.updateRefetchInterval(o)},r.getOptimisticResult=function(t){var e=this.client.defaultQueryObserverOptions(t),u=this.client.getQueryCache().build(this.client,e);return this.createResult(u,e)},r.getCurrentResult=function(){return this.currentResult},r.trackResult=function(t,e){var u=this,a={},c=function(l){u.trackedProps.includes(l)||u.trackedProps.push(l)};return Object.keys(t).forEach(function(o){Object.defineProperty(a,o,{configurable:!1,enumerable:!0,get:function(){return c(o),t[o]}})}),(e.useErrorBoundary||e.suspense)&&c("error"),a},r.getNextResult=function(t){var e=this;return new Promise(function(u,a){var c=e.subscribe(function(o){o.isFetching||(c(),o.isError&&(t!=null&&t.throwOnError)?a(o.error):u(o))})})},r.getCurrentQuery=function(){return this.currentQuery},r.remove=function(){this.client.getQueryCache().remove(this.currentQuery)},r.refetch=function(t){return this.fetch(Q({},t,{meta:{refetchPage:t==null?void 0:t.refetchPage}}))},r.fetchOptimistic=function(t){var e=this,u=this.client.defaultQueryObserverOptions(t),a=this.client.getQueryCache().build(this.client,u);return a.fetch().then(function(){return e.createResult(a,u)})},r.fetch=function(t){var e=this;return this.executeFetch(t).then(function(){return e.updateResult(),e.currentResult})},r.executeFetch=function(t){this.updateQuery();var e=this.currentQuery.fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(te)),e},r.updateStaleTimeout=function(){var t=this;if(this.clearStaleTimeout(),!(x||this.currentResult.isStale||!A(this.options.staleTime))){var e=re(this.currentResult.dataUpdatedAt,this.options.staleTime),u=e+1;this.staleTimeoutId=setTimeout(function(){t.currentResult.isStale||t.updateResult()},u)}},r.computeRefetchInterval=function(){var t;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(t=this.options.refetchInterval)!=null?t:!1},r.updateRefetchInterval=function(t){var e=this;this.clearRefetchInterval(),this.currentRefetchInterval=t,!(x||this.options.enabled===!1||!A(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(function(){(e.options.refetchIntervalInBackground||se.isFocused())&&e.executeFetch()},this.currentRefetchInterval))},r.updateTimers=function(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())},r.clearTimers=function(){this.clearStaleTimeout(),this.clearRefetchInterval()},r.clearStaleTimeout=function(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)},r.clearRefetchInterval=function(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)},r.createResult=function(t,e){var u=this.currentQuery,a=this.options,c=this.currentResult,o=this.currentResultState,l=this.currentResultOptions,d=t!==u,f=d?t.state:this.currentQueryInitialState,g=d?this.currentResult:this.previousQueryResult,h=t.state,O=h.dataUpdatedAt,T=h.error,w=h.errorUpdatedAt,_=h.isFetching,v=h.status,$=!1,U=!1,p;if(e.optimisticResults){var N=this.hasListeners(),X=!N&&H(t,e),Z=N&&W(t,u,e,a);(X||Z)&&(_=!0,O||(v="loading"))}if(e.keepPreviousData&&!h.dataUpdateCount&&(g!=null&&g.isSuccess)&&v!=="error")p=g.data,O=g.dataUpdatedAt,v=g.status,$=!0;else if(e.select&&typeof h.data<"u")if(c&&h.data===(o==null?void 0:o.data)&&e.select===this.selectFn)p=this.selectResult;else try{this.selectFn=e.select,p=e.select(h.data),e.structuralSharing!==!1&&(p=D(c==null?void 0:c.data,p)),this.selectResult=p,this.selectError=null}catch(b){k().error(b),this.selectError=b}else p=h.data;if(typeof e.placeholderData<"u"&&typeof p>"u"&&(v==="loading"||v==="idle")){var y;if(c!=null&&c.isPlaceholderData&&e.placeholderData===(l==null?void 0:l.placeholderData))y=c.data;else if(y=typeof e.placeholderData=="function"?e.placeholderData():e.placeholderData,e.select&&typeof y<"u")try{y=e.select(y),e.structuralSharing!==!1&&(y=D(c==null?void 0:c.data,y)),this.selectError=null}catch(b){k().error(b),this.selectError=b}typeof y<"u"&&(v="success",p=y,U=!0)}this.selectError&&(T=this.selectError,p=this.selectResult,w=Date.now(),v="error");var ee={status:v,isLoading:v==="loading",isSuccess:v==="success",isError:v==="error",isIdle:v==="idle",data:p,dataUpdatedAt:O,error:T,errorUpdatedAt:w,failureCount:h.fetchFailureCount,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>f.dataUpdateCount||h.errorUpdateCount>f.errorUpdateCount,isFetching:_,isRefetching:_&&v!=="loading",isLoadingError:v==="error"&&h.dataUpdatedAt===0,isPlaceholderData:U,isPreviousData:$,isRefetchError:v==="error"&&h.dataUpdatedAt!==0,isStale:M(t,e),refetch:this.refetch,remove:this.remove};return ee},r.shouldNotifyListeners=function(t,e){if(!e)return!0;var u=this.options,a=u.notifyOnChangeProps,c=u.notifyOnChangePropsExclusions;if(!a&&!c||a==="tracked"&&!this.trackedProps.length)return!0;var o=a==="tracked"?this.trackedProps:a;return Object.keys(t).some(function(l){var d=l,f=t[d]!==e[d],g=o==null?void 0:o.some(function(O){return O===l}),h=c==null?void 0:c.some(function(O){return O===l});return f&&!h&&(!o||g)})},r.updateResult=function(t){var e=this.currentResult;if(this.currentResult=this.createResult(this.currentQuery,this.options),this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,!ne(this.currentResult,e)){var u={cache:!0};(t==null?void 0:t.listeners)!==!1&&this.shouldNotifyListeners(this.currentResult,e)&&(u.listeners=!0),this.notify(Q({},u,t))}},r.updateQuery=function(){var t=this.client.getQueryCache().build(this.client,this.options);if(t!==this.currentQuery){var e=this.currentQuery;this.currentQuery=t,this.currentQueryInitialState=t.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))}},r.onQueryUpdate=function(t){var e={};t.type==="success"?e.onSuccess=!0:t.type==="error"&&!ie(t.error)&&(e.onError=!0),this.updateResult(e),this.hasListeners()&&this.updateTimers()},r.notify=function(t){var e=this;P.batch(function(){t.onSuccess?(e.options.onSuccess==null||e.options.onSuccess(e.currentResult.data),e.options.onSettled==null||e.options.onSettled(e.currentResult.data,null)):t.onError&&(e.options.onError==null||e.options.onError(e.currentResult.error),e.options.onSettled==null||e.options.onSettled(void 0,e.currentResult.error)),t.listeners&&e.listeners.forEach(function(u){u(e.currentResult)}),t.cache&&e.client.getQueryCache().notify({query:e.currentQuery,type:"observerResultsUpdated"})})},s}(ae);function he(n,s){return s.enabled!==!1&&!n.state.dataUpdatedAt&&!(n.state.status==="error"&&s.retryOnMount===!1)}function H(n,s){return he(n,s)||n.state.dataUpdatedAt>0&&C(n,s,s.refetchOnMount)}function C(n,s,r){if(s.enabled!==!1){var i=typeof r=="function"?r(n):r;return i==="always"||i!==!1&&M(n,s)}return!1}function W(n,s,r,i){return r.enabled!==!1&&(n!==s||i.enabled===!1)&&(!r.suspense||n.state.status!=="error")&&M(n,r)}function M(n,s){return n.isStaleByTime(s.staleTime)}var fe=function(n){G(s,n);function s(i,t){return n.call(this,i,t)||this}var r=s.prototype;return r.bindMethods=function(){n.prototype.bindMethods.call(this),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)},r.setOptions=function(t,e){n.prototype.setOptions.call(this,Q({},t,{behavior:L()}),e)},r.getOptimisticResult=function(t){return t.behavior=L(),n.prototype.getOptimisticResult.call(this,t)},r.fetchNextPage=function(t){var e;return this.fetch({cancelRefetch:(e=t==null?void 0:t.cancelRefetch)!=null?e:!0,throwOnError:t==null?void 0:t.throwOnError,meta:{fetchMore:{direction:"forward",pageParam:t==null?void 0:t.pageParam}}})},r.fetchPreviousPage=function(t){var e;return this.fetch({cancelRefetch:(e=t==null?void 0:t.cancelRefetch)!=null?e:!0,throwOnError:t==null?void 0:t.throwOnError,meta:{fetchMore:{direction:"backward",pageParam:t==null?void 0:t.pageParam}}})},r.createResult=function(t,e){var u,a,c,o,l,d,f=t.state,g=n.prototype.createResult.call(this,t,e);return Q({},g,{fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:ue(e,(u=f.data)==null?void 0:u.pages),hasPreviousPage:oe(e,(a=f.data)==null?void 0:a.pages),isFetchingNextPage:f.isFetching&&((c=f.fetchMeta)==null||(o=c.fetchMore)==null?void 0:o.direction)==="forward",isFetchingPreviousPage:f.isFetching&&((l=f.fetchMeta)==null||(d=l.fetchMore)==null?void 0:d.direction)==="backward"})},s}(Y);function de(){var n=!1;return{clearReset:function(){n=!1},reset:function(){n=!0},isReset:function(){return n}}}var ve=S.createContext(de()),pe=function(){return S.useContext(ve)};function Re(n,s,r){return typeof s=="function"?s.apply(void 0,r):typeof s=="boolean"?s:!!n}function z(n,s){var r=S.useRef(!1),i=S.useState(0),t=i[1],e=ce(),u=pe(),a=e.defaultQueryObserverOptions(n);a.optimisticResults=!0,a.onError&&(a.onError=P.batchCalls(a.onError)),a.onSuccess&&(a.onSuccess=P.batchCalls(a.onSuccess)),a.onSettled&&(a.onSettled=P.batchCalls(a.onSettled)),a.suspense&&(typeof a.staleTime!="number"&&(a.staleTime=1e3),a.cacheTime===0&&(a.cacheTime=1)),(a.suspense||a.useErrorBoundary)&&(u.isReset()||(a.retryOnMount=!1));var c=S.useState(function(){return new s(e,a)}),o=c[0],l=o.getOptimisticResult(a);if(S.useEffect(function(){r.current=!0,u.clearReset();var d=o.subscribe(P.batchCalls(function(){r.current&&t(function(f){return f+1})}));return o.updateResult(),function(){r.current=!1,d()}},[u,o]),S.useEffect(function(){o.setOptions(a,{listeners:!1})},[a,o]),a.suspense&&l.isLoading)throw o.fetchOptimistic(a).then(function(d){var f=d.data;a.onSuccess==null||a.onSuccess(f),a.onSettled==null||a.onSettled(f,null)}).catch(function(d){u.clearReset(),a.onError==null||a.onError(d),a.onSettled==null||a.onSettled(void 0,d)});if(l.isError&&!u.isReset()&&!l.isFetching&&Re(a.suspense,a.useErrorBoundary,[l.error,o.getCurrentQuery()]))throw l.error;return a.notifyOnChangeProps==="tracked"&&(l=o.trackResult(l,a)),l}function I(n,s,r){var i=K(n,s,r);return z(i,Y)}function J(n,s,r){var i=K(n,s,r);return z(i,fe)}async function m(n="",s="GET",r){const i=new URL(B.ENV.TMDB_API_BASE_URL+n);i.searchParams.set("api_key",B.ENV.TMDB_API_KEY);const t={method:s,headers:{"Content-Type":"application/json"}};try{const e=await fetch(i.toString(),t),u=await e.json();if(!e.ok){const a=u.status_message||"Unknown error occurred";throw console.log(a),new Error(a)}return u}catch(e){throw console.error(`Error Fetching Data: ${e}`),new Error("Failed to fetch data")}}class ge{getCategoryMediaParams(s){let r="";const i={...s};return le.forEach(t=>{i[t]&&(r&&(r+=","),r+=i[t],delete i[t])}),r&&(i.sort_by=r),this.getQueryParams(i)}getQueryParams(s){return new URLSearchParams(Object.entries(s).filter(r=>r[1]!==null&&r[1]!==void 0&&r[1]!=="")).toString()}}const j=new ge;class ye{getMedia(s,r){return m(r?s+"?"+j.getCategoryMediaParams(r):s)}getMediaDetails(s,r){return m(`${s}${r}`)}getMediaSearchResults(s,r){return m(s+"?"+j.getQueryParams(r))}getMediaRecomendations(s,r){return m(`${s.replace(V,r.toString())}`)}getGenres(s){return m(s)}getVideos(s,r){return m(`${s.replace(V,r)}`)}}const E=new ye,F=1e3*60*60*24,me=(n,s)=>I([`${n}-${s}`,s],()=>E.getMedia(q[n][s]),{staleTime:F}),Se=(n,s,r,i=!0)=>J({queryKey:[`${n}-${s}`,n,s,r],queryFn:({pageParam:t=1})=>E.getMedia(q[n][s],{...r,page:t}),enabled:i,getNextPageParam:t=>t.page+1<=t.total_pages?t.page+1:null,keepPreviousData:!0,staleTime:F}),Ee=(n,s)=>I([`${n}-details-${s}`,s,n],()=>E.getMediaDetails(n==="movies"?R.DETAILS_OF_MOVIE:R.DETAILS_OF_SHOWS,s)),be=(n,s)=>I([`${n}-recomendations-${s}`,s,n],()=>E.getMediaRecomendations(n==="movies"?R.MOVIE_RECOMENDATIONS:R.SHOW_RECOMENDATIONS,s)),Pe=(n,s)=>J({queryKey:[`${n}-search`,n,s],queryFn:({pageParam:r=1})=>E.getMediaSearchResults(n==="movies"?R.SEARCH_MOVIE:R.SEARCH_SHOWS,{...s,page:r}),enabled:s.query.length>0,getNextPageParam:r=>r.page+1<=r.total_pages?r.page+1:null,keepPreviousData:!0,staleTime:F}),Ie=n=>{const s=n==="movies"?R.GENRES_OF_MOVIES:R.GENRES_OF_SHOWS,{data:r,error:i}=I([`${n}-genres`],()=>E.getGenres(s));return i?[]:(r==null?void 0:r.genres)||[]},Qe=(n,s)=>{const r=n==="movies"?R.VIDEOS_OF_MOVIE:R.VIDEOS_OF_SHOW;return I([`${n}-videos-${s}`],()=>E.getVideos(r,s))};export{Qe as a,be as b,Pe as c,Ie as d,Se as e,me as f,Ee as u};
