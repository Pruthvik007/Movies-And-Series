import{j as s,Q as _,c as j,r as u,C as x}from"./index-DbknFPOW.js";import{u as y,E as p,S as N}from"./ErrorPage-BpY1NDLA.js";import{d as S,e as C}from"./TmdbQueries-CbQ1Dpot.js";import{M as T}from"./MediaList-yP9svaJY.js";const h=({label:o,options:r,value:e,onChange:a})=>s.jsxs("select",{id:o,className:"select select-bordered text-center overflow-hidden",value:e,onChange:t=>a(t.target.value),children:[s.jsx("option",{value:"",children:o}),r.map(t=>s.jsx("option",{value:t.value,children:t.label},t.value))]}),E=({mediaType:o,value:r,onChange:e})=>{const t=S(o).map(n=>({value:String(n.id),label:n.name}));return s.jsx(h,{label:"Genres",options:t,value:r,onChange:e})},P=({className:o="",mediaType:r,params:e,setParams:a})=>s.jsxs("div",{className:`flex gap-3 bg-base-100 p-5 w-full justify-center border-black rounded-lg ${o}`,children:[s.jsx(E,{mediaType:r,value:e.with_genres?e.with_genres:"",onChange:t=>a({...e,with_genres:t})}),s.jsx(h,{label:"Sort By Popularity",options:[{value:_.SORT_BY.VOTE_COUNT_DESC,label:"Descending"},{value:_.SORT_BY.VOTE_COUNT_ASC,label:"Ascending"}],value:e.sort_by_vote_count?e.sort_by_vote_count:"",onChange:t=>a({...e,sort_by_vote_count:t})})]}),M=()=>{const{ref:o,inView:r}=y(),{mediaType:e,category:a}=j(),t=(e==="movies"||e==="shows")&&a!==void 0&&a in x.categories,[n,d]=u.useState({with_genres:"",with_companies:"",sort_by:"",sort_by_date:"",sort_by_vote_average:"",sort_by_vote_count:"",include_adult:void 0,year:""});u.useEffect(()=>{const c=new URLSearchParams(window.location.search).get("with_genres"),l=new URLSearchParams(window.location.search).get("with_companies");c&&d(g=>({...g,with_genres:c})),l&&d(g=>({...g,with_companies:l}))},[]);const{data:i,error:v,fetchNextPage:m,isFetching:f,isFetchingNextPage:b,hasNextPage:w}=C(e,a,n);return u.useEffect(()=>{r&&w&&m()},[r]),t?v?s.jsx(p,{}):s.jsxs("div",{className:"p-3 flex flex-col gap-3",children:[s.jsx("p",{className:"text-3xl font-bold text-center py-3 text-neutral-content",children:`${x.categories[a].toUpperCase()} ${e.toUpperCase()}`}),a==="discover"&&s.jsx(P,{className:"py-3",mediaType:e,params:n,setParams:d}),i!==void 0&&s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 2xl:grid-cols-6 p-3 gap-3 bg-base-100 rounded-xl mx-auto",children:i.pages.map((c,l)=>s.jsx(T,{mediaList:c.results,mediaType:e,isLoading:f||b},l))}),i&&i.pages.length>=1&&s.jsx("div",{id:"observer",ref:o}),s.jsx(N,{})]}):s.jsx(p,{})};export{M as default};
