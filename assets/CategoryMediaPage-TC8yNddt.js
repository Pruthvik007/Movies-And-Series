import{j as e,m as s,Q as a,i as t,g as l,n as r,C as o,f as n}from"./index-vWfmPbfg.js";import{r as i}from"./react-BzPveaeN.js";import{u as c}from"./useFilters-D-Gay9YY.js";import{S as d}from"./ScrollToTopButton-PnQ9tzy-.js";import m from"./ErrorPage-CLdTP8w_.js";import"./query-C84XuELW.js";const x=i.memo((({label:s,options:a,value:t,onChange:l})=>e.jsxs("select",{id:s,className:"select select-bordered text-center overflow-hidden",value:t,onChange:e=>l(e.target.value),children:[e.jsx("option",{value:"",children:s}),a.map((s=>e.jsx("option",{value:s.value,children:s.label},s.value)))]}))),p=i.memo((({mediaType:a,value:t,onChange:l})=>{const r=s(a).map((e=>({value:String(e.id),label:e.name})));return e.jsx(x,{label:"Genres",options:r,value:t,onChange:l})})),u=i.memo((({className:s="",mediaType:a})=>{const{updateFilters:t,clearFilters:l,filters:r,isFiltersActive:o}=c(),n=i.useCallback((e=>{t("with_genres",e)}),[t]),d=i.useCallback((e=>{t("sort_by_vote_count",e)}),[t]);return e.jsxs("div",{className:`flex flex-col md:flex-row gap-3 bg-base-100 p-5 w-full justify-center border-black rounded-lg ${s}`,children:[e.jsx(p,{mediaType:a,value:r.with_genres?r.with_genres:"",onChange:n}),e.jsx(g,{value:r.sort_by_vote_count?r.sort_by_vote_count:"",onChange:d}),o()&&e.jsx("button",{className:"btn btn-md btn-active btn-warning rounded-xl",onClick:l,children:"Clear Filters"})]})})),g=i.memo((({value:s,onChange:t})=>e.jsx(x,{label:"Sort By Popularity",options:[{value:a.SORT_BY.VOTE_COUNT_DESC,label:"Descending"},{value:a.SORT_BY.VOTE_COUNT_ASC,label:"Ascending"}],value:s,onChange:t}))),v=()=>{const{ref:s,inView:a}=t(),{mediaType:x,category:p}=l(),g=("movies"===x||"shows"===x)&&void 0!==p&&p in o.categories,{filters:v,activeFilterName:h}=c(),{data:j,error:b,fetchNextPage:f,isFetching:C,hasNextPage:y}=r(x,p,v,g);return i.useEffect((()=>{a&&y&&f()}),[a]),g?b?e.jsx(m,{}):e.jsxs("div",{className:"p-3 flex flex-col gap-3 min-height-screen",children:[e.jsxs("div",{className:"flex flex-wrap justify-center gap-3 text-sm md:text-2xl font-bold py-3 text-neutral-content",children:[e.jsx("span",{children:`${o.categories[p].toUpperCase()} ${x.toUpperCase()}`}),e.jsx("span",{children:h?`(From ${h})`:""})]}),"discover"===p&&e.jsx(u,{className:"py-3",mediaType:x}),j&&(0!==j.pages[0].total_results?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 2xl:grid-cols-6 p-3 gap-3 bg-base-100 rounded-xl mx-auto",children:e.jsx(n,{mediaList:j.pages.flatMap((e=>e.results)),mediaType:x,isLoading:C})}):e.jsx("p",{className:"text-sm md:text-3xl text-warning mx-auto md:whitespace-nowrap text-center",children:"No Results Found For Given Category"})),j&&j.pages.length>=1&&e.jsx("div",{id:"observer",ref:s}),e.jsx(d,{})]}):e.jsx(m,{message:"Invalid Category"})};export{v as default};
